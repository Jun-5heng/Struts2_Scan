import click
import time
import sys
from pathlib import Path
import random
import hashlib
import string
import shlex

class handle_tools:
    @staticmethod
    def check_int(par_name, num_str):
        try:
            num_int = int(num_str)
            return num_int
        except Exception as e:
            click.secho(f"[ERROR] 参数{par_name}输入必须为整数!", fg='red')
            sys.exit(0)

    @staticmethod
    def get_hash():
        # time.sleep(0.05)
        random_str = ''.join(random.sample(string.ascii_letters, 10))
        hash = hashlib.md5(random_str.encode()).hexdigest()
        hash = hash[0:10]
        return hash

    @staticmethod
    def parser_cmd(cmd, type='string'):
        cmd = shlex.split(cmd)
        if type == 'string':
            cmd_str = '"' + '","'.join(cmd) + '"'
        elif type == 'xml':
            cmd_str = '<string>' + '</string><string>'.join(cmd) + '</string>'
        else:
            cmd_str = cmd
        return cmd_str

    @staticmethod
    def check_file(file_path):
        file_obj = Path(file_path)
        if file_obj.exists():
            return True
        else:
            click.secho("[ERROR] {file}文件不存在!".format(file=file_path), fg='red')
            exit(0)